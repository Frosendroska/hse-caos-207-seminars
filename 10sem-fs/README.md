# 10 Семинар 04.02.2022 filesystem

## Файлики с кодом:

* [Перечисление файлов и директорий](list_dirs.c)
* [Пример работы errno](errno_example.c)
* [Дерево из файлов](tree.c)


# Права доступа к файлам и директориям

## Параметры доступа

[r]ead - **файл**: читать, **директория**: просматривать содержимое (ls)

[w]rite - **файл**: изменять содержимое, **директория**: создавать новые файлы

e[x]ecute - **файл**: исполнять, **директория**: заходить в нее (cd)

## Категории пользователей

[u]ser - владелец файла (может быть только один)

[g]roup - любая группа пользователей (может быть только одна)

[o]ther - все остальные

[a]ll - все

## Тип файла

[copy from](https://github.com/blackav/hse-caos-2020/tree/master/12-files2#%D1%82%D0%B8%D0%BF%D1%8B-%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2)

1. [-] Обычный файл – наиболее распространенный тип файлов, который хранит данные в том или ином виде. Ядро UNIX не делает различий между текстовыми и двоичными файлами. Любая интерпретация содержимого файла полностью возлагается на прикладную программу, обрабатывающую файл.

2. [d] Файл каталога. Файлы этого типа содержат имена других файлов и ссылки на информацию о них. Любой процесс, обладающий правом на чтение каталога, может проверить его содержимое, но только ядро обладает правом на запись в файл каталога. Чтобы внести изменения в каталог, процессы должны пользоваться функциями, обсуждаемыми в данной главе.

3. [b] Специальный файл блочного устройства. Этот тип файлов обеспечивает буферизованный ввод вывод для таких устройств, как дисковые устройства с фиксированным размером блока.

4. [c] Специальный файл символьного устройства. Этот тип файлов обеспечивает небуферизованный ввод вывод для устройств с переменным размером блока. Все устройства в системе являются либо специальными файлами блочных устройств, либо специальными файлами символьных устройств.

5. [p] FIFO, или именованный канал. Этот тип файлов используется для организации обмена информацией между процессами.

6. [s] Сокет. Этот тип файлов используется для организации обмена информацией между процессами через сетевые соединения. Сокеты можно применять и для обмена информацией между процессами на одной и той же машине.

7. [l] Символическая ссылка. Файлы этого типа представляют собой ссылки на другие файлы.

## Специальные права доступа

При запуске программы используются effective uid и effective gid,
то есть влияют права не того пользователя (группы), кто создал файл,
а того, кто запускает.

[s]uid - установка этого бита позволяет запускать программу от имени владельца файла. То есть какие-то программы можно, например, запускать от имени суперпользователя (`ls -l /usr/bin/passwd`).

[s]gid - установка этого бита на файл позволяет запускать файл от имени группы, владеющей файлом. Если бит установлен на директории, то все файлы созданные в этой директории будут иметь группу такую же как у директории

s[t]icky - установка этого бита запрещает удалять файлы директории/файл всем, кроме root и владельца файла/директории. (`ls -ld /tmp/`)

## Строка прав

В символьном виде строка прав состоит из 10 символов:

```
        - --- --- ---
        ^ \|/ \|/ \|/
        |  |   |   |
      Тип  |   |   |
           |   |   |
       Права   |   |
   владельца   |   |
               |   |
           Права   |
          группы   |
                   |
               Права
           остальных
```



### Примеры

Строка прав имеют вид:

Строка прав формируется из 13 бит: тип [1], специальные права [3], user [3], group [3], other [3]. Тип мы менять не можем, остальное можем.




    - --- --- ---



